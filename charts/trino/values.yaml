# Trino Helm Chart Values
# Chart: trino/trino ou custom

# Image
image:
  repository: 10.10.0.101:30500/data-platform/trino
  tag: "435"
  pullPolicy: IfNotPresent

# Server Configuration
server:
  workers: 3
  node:
    environment: production
    dataDir: /data/trino
    pluginDir: /usr/lib/trino/plugin
  
  workerExtraConfig: ""
  
  exchangeManager:
    name: "filesystem"
    baseDir: "/tmp/trino-local-file-system-exchange-manager"

  log:
    trino:
      level: INFO
  config:
    path: /etc/trino
    http:
      port: 8080
    query:
      maxMemory: "50GB"
      maxMemoryPerNode: "10GB"
      maxTotalMemoryPerNode: "12GB"
  autoscaling:
    enabled: false

# Coordinator Configuration
coordinator:
  jvm:
    maxHeapSize: "8G"
    gcMethod:
      type: "UseG1GC"
      g1:
        heapRegionSize: "32M"
  config:
    memory:
      heapHeadroomPerNode: ""
    query:
      maxMemoryPerNode: "10GB"
  resources:
    requests:
      memory: "10Gi"
      cpu: "2000m"
    limits:
      memory: "16Gi"
      cpu: "4000m"
  livenessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6
    successThreshold: 1
  readinessProbe:
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6
    successThreshold: 1

# Worker Configuration
worker:
  jvm:
    maxHeapSize: "8G"
    gcMethod:
      type: "UseG1GC"
      g1:
        heapRegionSize: "32M"
  config:
    memory:
      heapHeadroomPerNode: ""
    query:
      maxMemoryPerNode: "10GB"
  resources:
    requests:
      memory: "10Gi"
      cpu: "2000m"
    limits:
      memory: "16Gi"
      cpu: "4000m"
  livenessProbe:
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6
    successThreshold: 1
  readinessProbe:
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6
    successThreshold: 1

# Service
service:
  type: NodePort
  port: 8080
  nodePort: 30808

# Additional Catalogs
additionalCatalogs:
  iceberg: |
    connector.name=iceberg
    iceberg.catalog.type=hadoop
    hive.metastore.uri=thrift://hive-metastore:9083
    iceberg.file-format=PARQUET
    hive.s3.endpoint=http://minio.minio.svc:9000
    hive.s3.path-style-access=true
    hive.s3.aws-access-key=minioadmin
    hive.s3.aws-secret-key=minioadmin123
  
  postgresql: |
    connector.name=postgresql
    connection-url=jdbc:postgresql://postgres:5432/mydb
    connection-user=admin
    connection-password=password

# Security
auth:
  enabled: false

# Ingress
ingress:
  enabled: false

# ServiceAccount
serviceAccount:
  create: true
  name: trino

# Affinity
affinity: {}

# Node Selector
nodeSelector: {}

# Tolerations
tolerations: []

# Additional Node Properties
additionalNodeProperties: {}

# Additional Config Properties
additionalConfigProperties: {}

# Additional Log Properties
additionalLogProperties: {}

# Additional JVM Config
additionalJVMConfig: {}

shareProcessNamespace:
  coordinator: false
  worker: false

initContainers:
  coordinator: []
  worker: []

kafka:
  mountPath: "/etc/trino/schemas"

sidecarContainers:
  coordinator: []
  worker: []
